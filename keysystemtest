--// ================== ROBLOX AUTH SYSTEM ================== //-- 

local Http = game:GetService("HttpService")
local hwid = game:GetService("RbxAnalyticsService"):GetClientId()
local API_URL = "https://allyson-unprevailing-fae.ngrok-free.dev/auth" -- <--- Change this to your server URL

local keyFile = "authkey.txt"

-- Load saved key if exists
local function loadKey()
    if isfile(keyFile) then
        return readfile(keyFile)
    end
end

local key = _G.Key or loadKey()

if not key then
    return game.Players.LocalPlayer:Kick("â— Set your key first: _G.Key = \"YOUR_KEY\"")
end

-- Auto save key
pcall(function()
    writefile(keyFile, key)
end)

-- Select request function
local request = syn and syn.request or http_request or request or (http and http.request)

local response = request({
    Url = API_URL,
    Method = "POST",
    Headers = {["Content-Type"] = "application/json"},
    Body = Http:JSONEncode({key = key, hwid = hwid})
})

local data = Http:JSONDecode(response.Body)

-- Error Handling
if not data.success then
    local msg = {
        INVALID = "âŒ Invalid Key",
        EXPIRED = "â›” Your Key Has Expired",
        HWID_MISMATCH = "ðŸ›‘ HWID doesn't match",
        NO_KEY = "â— No Key Provided"
    }

    return game.Players.LocalPlayer:Kick(msg[data.reason] or "Unknown Error")
end

print("ðŸ” Key Authorized Successfully")

-- Display Owner Info
local owner = data.owner or "None"
local discordID = data.discordID or "N/A"

if owner ~= "None" then
    print("ðŸ‘¤ Owner:", owner, "(Discord ID:", discordID, ")")
else
    print("ðŸ‘¤ No owner was detected for this key")
end

-- Expiration & Time Remaining
if data.expires and data.expires ~= "lifetime" then
    local expiry = DateTime.fromIsoDate(data.expires)
    local remaining = expiry.UnixTimestamp - DateTime.now().UnixTimestamp

    local days = math.floor(remaining / 86400)
    local hours = math.floor((remaining % 86400) / 3600)
    local minutes = math.floor((remaining % 3600) / 60)

    print("ðŸ“… Expires on:", data.expires)
    print(string.format("â³ Time Left: %d Days %d Hours %d Min", days, hours, minutes))
else
    print("â™¾ Lifetime Key")
end

print("ðŸš€ Script Loaded Successfully")
print("=============================================")

