local Http = game:GetService("HttpService")
local hwid = game:GetService("RbxAnalyticsService"):GetClientId()
local keyFile = "authkey.txt"

-- Load saved key if exists
local function loadKey()
    if isfile(keyFile) then
        return readfile(keyFile)
    end
end

local key = _G.Key or loadKey()

if not key then
    return game.Players.LocalPlayer:Kick("â— Insert your key before executing : _G.Key = \"YOUR_KEY\"")
end

-- Auto save key
pcall(function()
    writefile(keyFile, key)
end)

local req = syn and syn.request or http_request or request
local response = req({
    Url = "https://allyson-unprevailing-fae.ngrok-free.dev/auth", -- Change URL
    Method = "POST",
    Headers = {["Content-Type"]="application/json"},
    Body = Http:JSONEncode({key=key, hwid=hwid})
})

local data = Http:JSONDecode(response.Body)

-- Error handling (English)
if not data.success then
    local reason = data.reason or "UNKNOWN"

    local message = ({
        INVALID = "âŒ Invalid key!",
        EXPIRED = "â›” Your key has expired!",
        HWID_MISMATCH = "ğŸ›‘ HWID mismatch!",
        NO_KEY = "â— No key provided!"
    })[reason] or "Unknown error."

    return game.Players.LocalPlayer:Kick(message)
end

print("âœ” Key Authorized")

-- Expiration & time left
if data.expires then
    local expiry = DateTime.fromIsoDate(data.expires)
    local remaining = expiry.UnixTimestamp - DateTime.now().UnixTimestamp

    local days = math.floor(remaining/86400)
    local hours = math.floor((remaining%86400)/3600)
    local minutes = math.floor((remaining%3600)/60)

    print("ğŸ“… Expires on : "..data.expiresReadable)
    print(string.format("â³ Time Left: %d days %d hours %d min", days, hours, minutes))
else
    print("â™¾ Lifetime Key")
end

print(">>> Script Successfully Loaded ğŸš€ <<<")
