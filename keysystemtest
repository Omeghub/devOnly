--// ================== ROBLOX AUTH SYSTEM ================== //--

local Http = game:GetService("HttpService")
local hwid = game:GetService("RbxAnalyticsService"):GetClientId()
local API_URL = "https://allyson-unprevailing-fae.ngrok-free.dev/auth" -- <--- CHANGE ICI

local keyFile = "authkey.txt"

-- Load saved key
local function loadKey()
    if isfile(keyFile) then
        return readfile(keyFile)
    end
end

local key = _G.Key or loadKey()

if not key then
    return game.Players.LocalPlayer:Kick("â— Set your key first : _G.Key = \"YOUR_KEY\"")
end

-- Auto Save Key
pcall(function()
    writefile(keyFile, key)
end)

local request = syn and syn.request or http_request or request or (http and http.request)

local response = request({
    Url = API_URL,
    Method = "POST",
    Headers = {["Content-Type"] = "application/json"},
    Body = Http:JSONEncode({key = key, hwid = hwid})
})

local data = Http:JSONDecode(response.Body)

-- Error Handler
if not data.success then
    local msg = {
        INVALID_KEY = "âŒ Invalid Key",
        EXPIRED = "â›” Your Key Has Expired",
        HWID_MISMATCH = "ðŸ›‘ HWID Doesn't Match This Key",
        NO_KEY = "â— No Key Provided"
    }

    return game.Players.LocalPlayer:Kick(msg[data.reason] or "Unknown Error")
end

print("ðŸ” Key Authorized Successfully")

-- Display Owner from webhook / claim
if data.owner ~= "None" then
    print("ðŸ‘¤ Owner :", data.owner, "(Discord ID:", data.discordID .. ")")
else
    print("ðŸ‘¤ No owner was detected for this key")
end

-- Expiration Display
if data.expires ~= "lifetime" then
    local expiry = DateTime.fromIsoDate(data.expires)
    local remaining = expiry.UnixTimestamp - DateTime.now().UnixTimestamp

    local d = math.floor(remaining/86400)
    local h = math.floor((remaining%86400)/3600)
    local m = math.floor((remaining%3600)/60)

    print("ðŸ“… Expires on :", data.expires)
    print(string.format("â³ Time Left: %d Days %d Hours %d Min", d, h, m))
else
    print("â™¾ Lifetime Key")
end

print("ðŸš€ Script Loaded Successfully")
print("=============================================")

-- â†“ Here start your script (load UI, execute hub, etc) â†“

-- loadstring(game:HttpGet("https://your-script-hub.com/loader.lua"))()
